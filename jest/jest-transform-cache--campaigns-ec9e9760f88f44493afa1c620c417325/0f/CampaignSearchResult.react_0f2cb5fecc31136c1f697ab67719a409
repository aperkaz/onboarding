'use strict';Object.defineProperty(exports, "__esModule", { value: true });var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();var _class, _temp;var _reactBootstrapTable = require('react-bootstrap-table');
var _react = require('react');var _react2 = _interopRequireDefault(_react);
var _DeleteModal = require('../common/DeleteModal.react');var _DeleteModal2 = _interopRequireDefault(_DeleteModal);
var _lodash = require('lodash');var _lodash2 = _interopRequireDefault(_lodash);
var _DateConverter = require('opuscapita-i18n/lib/converters/DateConverter');var _DateConverter2 = _interopRequireDefault(_DateConverter);
var _reactIntl = require('react-intl');
require('./customTableStyles.css');
var _StartModal = require('../common/StartModal.react');var _StartModal2 = _interopRequireDefault(_StartModal);function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self, call) {if (!self) {throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call && (typeof call === "object" || typeof call === "function") ? call : self;}function _inherits(subClass, superClass) {if (typeof superClass !== "function" && superClass !== null) {throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);}subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } });if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;}var

CampaignSearchResult = (_temp = _class = function (_Component) {_inherits(CampaignSearchResult, _Component);













  function CampaignSearchResult(props) {_classCallCheck(this, CampaignSearchResult);var _this = _possibleConstructorReturn(this, (CampaignSearchResult.__proto__ || Object.getPrototypeOf(CampaignSearchResult)).call(this,
    props));
    _this.state = {
      deleteCampaignModalOpen: false,
      startCampaignModalOpen: false };return _this;

  }_createClass(CampaignSearchResult, [{ key: 'hideDeleteModal', value: function hideDeleteModal()

    {
      this.setState({
        deleteCampaignModalOpen: false,
        deletingCampaignId: undefined });

    } }, { key: 'showDeleteModal', value: function showDeleteModal(

    campaign) {
      this.setState({
        deleteCampaignModalOpen: true,
        deletingCampaignId: campaign.campaignId });

    } }, { key: 'showStartModal', value: function showStartModal(

    campaign) {
      this.setState({
        startCampaignModalOpen: true,
        startingCampaignId: campaign.campaignId });

      this.props.loadCampaignContacts(campaign.campaignId);
    } }, { key: 'hideStartModal', value: function hideStartModal()

    {
      this.setState({
        startCampaignModalOpen: false,
        startingCampaignId: undefined });

    } }, { key: 'formatDateField', value: function formatDateField(

    cell, row) {var _context =
      this.context,locale = _context.locale,formatPatterns = _context.formatPatterns;
      var dateConverter = new _DateConverter2.default(formatPatterns[locale].datePattern, locale);

      if (!_lodash2.default.isUndefined(cell) && !_lodash2.default.isNull(cell)) {
        return dateConverter.valueToString(cell);
      }

      return cell;
    } }, { key: 'renderActionPanel', value: function renderActionPanel(

    cell, row) {var _this2 = this;var
      intl = this.props.intl;
      return (
        _react2.default.createElement('div', { className: 'btn-group' },
          _react2.default.createElement('button', { className: 'btn btn-sm btn-default', onClick: function onClick() {return _this2.props.onEdit(row.campaignId);} },
            _react2.default.createElement('span', { className: 'glyphicon glyphicon-edit' }),
            intl.formatMessage({ id: 'campaignEditor.searchResult.button.edit' })),


          _react2.default.createElement('button', { className: 'btn btn-sm btn-default', onClick: function onClick() {return _this2.props.onGoToContacts(row.campaignId);} },
            _react2.default.createElement('span', { className: 'glyphicon glyphicon-envelope' }),
            intl.formatMessage({ id: 'campaignEditor.searchResult.button.contacts' })),


          _react2.default.createElement('button', { className: 'btn btn-sm btn-default', onClick: function onClick() {
                _this2.showDeleteModal(row);
              } },

            _react2.default.createElement('span', { className: 'glyphicon glyphicon-trash' }),
            intl.formatMessage({ id: 'campaignEditor.searchResult.button.delete' })),

          row.status === 'new' ? _react2.default.createElement('button', { className: 'btn btn-sm btn-default', onClick: function onClick() {
                _this2.showStartModal(row);
              } },
            _react2.default.createElement('span', { className: 'glyphicon' }),
            intl.formatMessage({ id: 'campaignEditor.searchResult.button.start' })) :
          false));




    } }, { key: 'render', value: function render()

    {var _this3 = this;var
      intl = this.props.intl;
      if (_lodash2.default.size(this.props.campaigns) > 0) {
        return (
          _react2.default.createElement('div', null,
            _react2.default.createElement(_reactBootstrapTable.BootstrapTable, { data: this.props.campaigns, condensed: true, bordered: false, striped: true, hover: true },
              _react2.default.createElement(_reactBootstrapTable.TableHeaderColumn, { dataField: 'campaignId', isKey: true, dataAlign: 'left', dataSort: true },
                intl.formatMessage({ id: 'campaignEditor.searchResult.campaignId.label' })),


              _react2.default.createElement(_reactBootstrapTable.TableHeaderColumn, { dataFormat: this.formatDateField.bind(this), dataField: 'startsOn', dataAlign: 'left',
                  dataSort: true },

                intl.formatMessage({ id: 'campaignEditor.searchResult.startsOn.label' })),

              _react2.default.createElement(_reactBootstrapTable.TableHeaderColumn, { dataFormat: this.formatDateField.bind(this), dataField: 'endsOn', dataAlign: 'left', dataSort: true },
                intl.formatMessage({ id: 'campaignEditor.searchResult.endsOn.label' })),


              _react2.default.createElement(_reactBootstrapTable.TableHeaderColumn, { dataField: 'status', dataSort: true, dataAlign: 'left' },
                intl.formatMessage({ id: 'campaignEditor.searchResult.status.label' })),

              _react2.default.createElement(_reactBootstrapTable.TableHeaderColumn, { dataField: 'campaignType', dataSort: true, dataAlign: 'left' },
                intl.formatMessage({ id: 'campaignEditor.searchResult.campaignType.label' })),

              _react2.default.createElement(_reactBootstrapTable.TableHeaderColumn, { dataField: 'owner', dataSort: true, dataAlign: 'left' },
                intl.formatMessage({ id: 'campaignEditor.searchResult.owner.label' })),

              _react2.default.createElement(_reactBootstrapTable.TableHeaderColumn, { dataAlign: 'right', dataFormat: this.renderActionPanel.bind(this) })),

            _react2.default.createElement(_DeleteModal2.default, {
              isOpen: this.state.deleteCampaignModalOpen,
              onDelete: function onDelete() {
                _this3.props.onDeleteCampaign(_this3.state.deletingCampaignId);
              },
              onHide: this.hideDeleteModal.bind(this) }),

            this.state.startCampaignModalOpen &&
            _react2.default.createElement(_StartModal2.default, {
              isOpen: this.state.startCampaignModalOpen,
              onStart: function onStart() {
                _this3.props.onStartCampaign(_this3.state.startingCampaignId);
              },
              onHide: this.hideStartModal.bind(this),
              contacts: this.props.contacts })));






      }
      return null;
    } }]);return CampaignSearchResult;}(_react.Component), _class.propTypes = { campaigns: _react.PropTypes.array, onDeleteCampaign: _react.PropTypes.func.isRequired, onEdit: _react.PropTypes.func.isRequired, onGoToContacts: _react.PropTypes.func.isRequired }, _class.contextTypes = { locale: _react2.default.PropTypes.string.isRequired, formatPatterns: _react2.default.PropTypes.object.isRequired }, _temp);exports.default =



(0, _reactIntl.injectIntl)(CampaignSearchResult);