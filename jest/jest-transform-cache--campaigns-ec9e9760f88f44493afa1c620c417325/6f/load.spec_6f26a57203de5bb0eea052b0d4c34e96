'use strict';var _load = require('../../../client/actions/campaignContacts/load');var actions = _interopRequireWildcard(_load);
var _campaignContacts = require('../../../client/constants/campaignContacts');




var _notification = require('../../../client/actions/notification');
var _lodash = require('lodash');var _lodash2 = _interopRequireDefault(_lodash);
var _reduxMockStore = require('redux-mock-store');var _reduxMockStore2 = _interopRequireDefault(_reduxMockStore);
var _reduxThunk = require('redux-thunk');var _reduxThunk2 = _interopRequireDefault(_reduxThunk);
var _jasminePit = require('jasmine-pit');var _jasminePit2 = _interopRequireDefault(_jasminePit);function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}function _interopRequireWildcard(obj) {if (obj && obj.__esModule) {return obj;} else {var newObj = {};if (obj != null) {for (var key in obj) {if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];}}newObj.default = obj;return newObj;}}
var middlewares = [_reduxThunk2.default];
var mockStore = (0, _reduxMockStore2.default)(middlewares);

_jasminePit2.default.install(window);
var mockResponse = function mockResponse(status, statusText, response) {
  return new window.Response(response, {
    status: status,
    statusText: statusText,
    headers: {
      'Content-type': 'application/json' } });


};

it('calls request and success actions if the fetch response was successful', function () {
  var store = mockStore({
    serviceRegistry: [{
      currentApplication: true,
      location: "127.0.0.1:8080/campaigns",
      name: "campaigns" }] });


  window.fetch = jest.fn().mockImplementation(function () {return (
      Promise.resolve(mockResponse(200, null, '{"campaignId":"ff"}')));});

  return store.dispatch(actions.loadCampaignContacts('ff')).
  then(function () {
    var expectedActions = store.getActions();
    console.log('-----expectedActions-----', expectedActions);
    expect(expectedActions.length).toBe(5);
    expect(expectedActions[0]).toEqual({ type: _campaignContacts.CAMPAIGN_CONTACTS_LOAD_START });
    expect(expectedActions[2].type).toEqual('SHOW_NOTIFICATION');
    expect(expectedActions[4]).toEqual({ type: 'REMOVE_NOTIFICATION' });
  });
});